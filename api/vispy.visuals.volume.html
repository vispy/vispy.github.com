
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vispy.visuals.volume module &#8212; VisPy</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/font-mfizz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="vispy.visuals.windbarb module" href="vispy.visuals.windbarb.html" />
    <link rel="prev" title="vispy.visuals.visual module" href="vispy.visuals.visual.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/vispy-teaser-short.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../installation.html">Installation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../getting_started/index.html">Getting Started</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../overview.html">Documentation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../gallery.html">Gallery</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="modules.html">API</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../news.html">News</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/vispy/vispy" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/vispyproject" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
          
            
                <li class="active">
                    <a href="vispy.html">vispy package</a>
                </li>
            
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#about-this-technique" class="nav-link">About this technique</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/vispy/vispy-website/edit/master/api/vispy.visuals.volume.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-vispy.visuals.volume">
<span id="vispy-visuals-volume-module"></span><h1>vispy.visuals.volume module<a class="headerlink" href="#module-vispy.visuals.volume" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about-this-technique">
<h2>About this technique<a class="headerlink" href="#about-this-technique" title="Permalink to this headline">¶</a></h2>
<p>In Python, we define the six faces of a cuboid to draw, as well as
texture cooridnates corresponding with the vertices of the cuboid. 
The back faces of the cuboid are drawn (and front faces are culled)
because only the back faces are visible when the camera is inside the 
volume.</p>
<p>In the vertex shader, we intersect the view ray with the near and far 
clipping planes. In the fragment shader, we use these two points to
compute the ray direction and then compute the position of the front
cuboid surface (or near clipping plane) along the view ray.</p>
<p>Next we calculate the number of steps to walk from the front surface
to the back surface and iterate over these positions in a for-loop.
At each iteration, the fragment color or other voxel information is 
updated depending on the selected rendering method.</p>
<p>It is important for the texture interpolation is ‘linear’ for most volumes,
since with ‘nearest’ the result can look very ugly; however for volumes with
discrete data ‘nearest’ is sometimes appropriate. The wrapping should be
clamp_to_edge to avoid artifacts when the ray takes a small step outside the
volume.</p>
<p>The ray direction is established by mapping the vertex to the document
coordinate frame, adjusting z to +/-1, and mapping the coordinate back.
The ray is expressed in coordinates local to the volume (i.e. texture
coordinates).</p>
<dl class="py class">
<dt id="vispy.visuals.volume.VolumeVisual">
<em class="property">class </em><code class="sig-prename descclassname">vispy.visuals.volume.</code><code class="sig-name descname">VolumeVisual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vol</span></em>, <em class="sig-param"><span class="n">clim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'mip'</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">relative_step_size</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'grays'</span></em>, <em class="sig-param"><span class="n">gamma</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">clim_range_threshold</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">emulate_texture</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">interpolation</span><span class="o">=</span><span class="default_value">'linear'</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/vispy/vispy/blob/master/vispy/visuals/volume.py#L387-L803"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="vispy.visuals.visual.html#vispy.visuals.visual.Visual" title="vispy.visuals.visual.Visual"><code class="xref py py-class docutils literal notranslate"><span class="pre">vispy.visuals.visual.Visual</span></code></a></p>
<p>Displays a 3D Volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vol</strong><span class="classifier">ndarray</span></dt><dd><p>The volume to display. Must be ndim==3.</p>
</dd>
<dt><strong>clim</strong><span class="classifier">tuple of two floats | None</span></dt><dd><p>The contrast limits. The values in the volume are mapped to
black and white corresponding to these values. Default maps
between min and max.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{‘mip’, ‘translucent’, ‘additive’, ‘iso’}</span></dt><dd><p>The render method to use. See corresponding docs for details.
Default ‘mip’.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">float</span></dt><dd><p>The threshold to use for the isosurface render method. By default
the mean of the given volume is used.</p>
</dd>
<dt><strong>relative_step_size</strong><span class="classifier">float</span></dt><dd><p>The relative step size to step through the volume. Default 0.8.
Increase to e.g. 1.5 to increase performance, at the cost of
quality.</p>
</dd>
<dt><strong>cmap</strong><span class="classifier">str</span></dt><dd><p>Colormap to use.</p>
</dd>
<dt><strong>gamma</strong><span class="classifier">float</span></dt><dd><p>Gamma to use during colormap lookup.  Final color will be cmap(val**gamma).
by default: 1.</p>
</dd>
<dt><strong>clim_range_threshold</strong><span class="classifier">float</span></dt><dd><p>When changing the clims, if the new clim range is smaller than this fraction of the
last-used texture data range, then it will trigger a rescaling of the texture data.
For instance: if the texture data was last scaled from 0-1, and the clims are set to
0.4-0.5, then a texture rescale will be triggered if <code class="docutils literal notranslate"><span class="pre">clim_range_threshold</span> <span class="pre">&lt;</span> <span class="pre">0.1</span></code>.
To prevent rescaling, set this value to 0.  To <em>always</em> rescale, set the value to
&gt;= 1.  By default, 0.2</p>
</dd>
<dt><strong>emulate_texture</strong><span class="classifier">bool</span></dt><dd><p>Use 2D textures to emulate a 3D texture. OpenGL ES 2.0 compatible,
but has lower performance on desktop platforms.</p>
</dd>
<dt><strong>interpolation</strong><span class="classifier">{‘linear’, ‘nearest’}</span></dt><dd><p>Selects method of image interpolation.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.clim">
<em class="property">property </em><code class="sig-name descname">clim</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.clim" title="Permalink to this definition">¶</a></dt>
<dd><p>The contrast limits that were applied to the volume data.</p>
<p>Volume display is mapped from black to white with these values.
Settable via set_data() as well as &#64;clim.setter.</p>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.clim_normalized">
<em class="property">property </em><code class="sig-name descname">clim_normalized</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.clim_normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize current clims between 0-1 based on last-used texture data range.</p>
<p>In set_data(), the data is normalized (on the CPU) to 0-1 using <code class="docutils literal notranslate"><span class="pre">clim</span></code>.
During rendering, the frag shader will apply the final contrast adjustment based on
the current <code class="docutils literal notranslate"><span class="pre">clim</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.cmap">
<em class="property">property </em><code class="sig-name descname">cmap</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.cmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.gamma">
<em class="property">property </em><code class="sig-name descname">gamma</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>The gamma used when rendering the image.</p>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.interpolation">
<em class="property">property </em><code class="sig-name descname">interpolation</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>The interpolation method to use</p>
<p>Current options are:</p>
<blockquote>
<div><ul class="simple">
<li><p>linear: this method is appropriate for most volumes as it creates
nice looking visuals.</p></li>
<li><p>nearest: this method is appropriate for volumes with discrete
data where additional interpolation does not make sense.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.method">
<em class="property">property </em><code class="sig-name descname">method</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.method" title="Permalink to this definition">¶</a></dt>
<dd><p>The render method to use</p>
<p>Current options are:</p>
<blockquote>
<div><ul class="simple">
<li><p>translucent: voxel colors are blended along the view ray until
the result is opaque.</p></li>
<li><p>mip: maxiumum intensity projection. Cast a ray and display the
maximum value that was encountered.</p></li>
<li><p>additive: voxel colors are added along the view ray until
the result is saturated.</p></li>
<li><p>iso: isosurface. Cast a ray until a certain threshold is
encountered. At that location, lighning calculations are
performed to give the visual appearance of a surface.</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.relative_step_size">
<em class="property">property </em><code class="sig-name descname">relative_step_size</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.relative_step_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative step size used during raycasting.</p>
<p>Larger values yield higher performance at reduced quality. If
set &gt; 2.0 the ray skips entire voxels. Recommended values are
between 0.5 and 1.5. The amount of quality degredation depends
on the render method.</p>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.rescale_data">
<code class="sig-name descname">rescale_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/vispy/vispy/blob/master/vispy/visuals/volume.py#L547-L559"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.rescale_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Force rescaling of data to the current contrast limits and texture upload.</p>
<p>Because Textures are currently 8-bits, and contrast adjustment is done during
rendering by scaling the values retrieved from the texture on the GPU (provided that
the new contrast limits settings are within the range of the clims used when the
last texture was uploaded), posterization may become visible if the contrast limits
become <em>too</em> small of a fraction of the clims used to normalize the texture.
This function is a convenience to “force” rescaling of the Texture data to the
current contrast limits range.</p>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.set_data">
<code class="sig-name descname">set_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vol</span></em>, <em class="sig-param"><span class="n">clim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/vispy/vispy/blob/master/vispy/visuals/volume.py#L487-L545"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the volume data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vol</strong><span class="classifier">ndarray</span></dt><dd><p>The 3D volume.</p>
</dd>
<dt><strong>clim</strong><span class="classifier">tuple | None</span></dt><dd><p>Colormap limits to use. None will use the min and max values.</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool | True</span></dt><dd><p>Whether to copy the input volume prior to applying clim normalization.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.texture_is_inverted">
<em class="property">property </em><code class="sig-name descname">texture_is_inverted</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.texture_is_inverted" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="vispy.visuals.volume.VolumeVisual.threshold">
<em class="property">property </em><code class="sig-name descname">threshold</code><a class="headerlink" href="#vispy.visuals.volume.VolumeVisual.threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>The threshold value to apply for the isosurface render method.</p>
</dd></dl>

</dd></dl>

</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="vispy.visuals.visual.html" title="previous page">vispy.visuals.visual module</a>
    <a class='right-next' id="next-link" href="vispy.visuals.windbarb.html" title="next page">vispy.visuals.windbarb module</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2013-2021, VisPy developers.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.4.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>